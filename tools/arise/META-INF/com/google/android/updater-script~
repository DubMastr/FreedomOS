run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
ui_print("ARISE Aroma Installer");
ui_print(" Brought to you by: ");
ui_print("<> TEAM ARISE <>");
ui_print("guitardedhero");
ui_print("Ben Feutrill");
ui_print("Sonophilos");
ui_print("Aroma by RP");
ui_print("Deleting previous install...");
delete_recursive("/system/app/As");
delete_recursive("/system/app/AsUI");
delete_recursive("/system/priv-app/As");
delete_recursive("/system/priv-app/AsUI");
delete_recursive("/system/app/Ds");
delete_recursive("/system/app/DsUI");
delete_recursive("/system/priv-app/Ds");
delete_recursive("/system/priv-app/DsUI");
delete_recursive("/system/dolby");
delete_recursive("/system/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete("/system/lib/libstagefright_soft_ddpdec.so");
delete("/system/vendor/lib/libstagefright_soft_ddpdec.so");
delete("/vendor/lib/libstagefright_soft_ddpdec.so");
delete("/system/lib/soundfx/libdseffect.so");
delete("/system/lib/libdlbdapstorage.so");
delete("/system/vendor/lib/libdlbdapstorage.so");
delete("/vendor/lib/libdlbdapstorage.so");
delete("/system/lib/soundfx/libswdap-mod.so");
delete("/system/lib/soundfx/libswdap.so");
delete("/system/vendor/lib/soundfx/libswdap.so");
delete("/vendor/lib/soundfx/libswdap.so");
delete("/system/lib/soundfx/libhwdap.so");
delete("/system/vendor/lib/soundfx/libhwdap.so");
delete("/vendor/lib/soundfx/libhwdap.so");
delete("/system/vendor/lib/soundfx/libswdapdolby.so");
delete("/system/lib/soundfx/libswdapdolby.so");
delete("/vendor/lib/soundfx/libswdapdolby.so");
delete("/system/vendor/lib/libhwdaphal.so");
delete("/vendor/lib/libhwdaphal.so");
delete("/system/app/ViPER4Android.apk");
delete("/system/priv-app/ViPER4Android.apk");
delete_recursive("/system/priv-app/ViPER4Android");
delete_recursive("/system/app/ViPER4Android");
delete_recursive("/system/priv-app/ViPER4AndroidFX-2.4.0.1");
delete_recursive("/system/app/ViPER4AndroidFX-2.4.0.1");
delete("/system/app/ViPER4Android FX-2.4.0.1.apk");
delete("/system/priv-app/ViPER4Android FX-2.4.0.1.apk");
delete_recursive("/system/priv-app/ViPER4Android FX-2.4.0.1");
delete_recursive("/system/app/ViPER4Android FX-2.4.0.1");
delete_recursive("/system/app/ViPER4Android_FX_A4.x");
delete_recursive("/system/priv-app/ViPER4Android_FX_A4.x");
delete_recursive("/system/app/Material_Dark_V4A");
delete_recursive("/system/priv-app/Material_Dark_V4A");
delete_recursive("/system/priv-app/MaterialDarkV4A");
delete_recursive("/system/priv-app/MaterialLightV4A");
delete("/system/lib/soundfx/libv4a_fx_ics.so");
delete("/system/lib/soundfx/libv4a_fx_jb.so");
delete("/system/addon.d/23-v4a.sh");
delete("/system/addon.d/23-v4adap.sh");
delete("/system/addon.d/23-v4addp.sh");
delete("/system/etc/init.d/50viper");
delete("/system/xbin/seinfo");
delete("/system/xbin/sepolicy-inject");
delete("/system/xbin/sesearch");
delete("/system/ViPER Version Info.txt");
delete("/system/ReDUX Version Info.txt");
delete_recursive("/system/app/AudioFX");
delete_recursive("/system/priv-app/AudioFX");
delete_recursive("/system/app/DSPManager");
delete_recursive("/system/priv-app/DSPManager");
ui_print("Extracting sound system...");
package_extract_dir("system","/system");
package_extract_dir("vendor","/system/vendor");
#JB/KK
if 

file_getprop("/tmp/aroma/info.prop","selected.1") == "1" 
then
ui_print("Configuring for JB/KK...");
package_extract_dir("v4a","/system/priv-app");
#DTS SYSTEM
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "1" 
then
ui_print("Installing DTS as system app...");

package_extract_dir("dts","/system/app");
endif;
#DTS DATA
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "2" 
then
ui_print("Installing DTS as user app...");
package_extract_dir("datadts","/data/app");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "1" 
then
ui_print("Installing Boomsound Preset...");
package_extract_dir("boomsound_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "2" 
then  
ui_print("Installing Harmon Kardon Preset...");
package_extract_dir("hk_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "3" 
then 
ui_print("Installing JBL Preset...");
package_extract_dir("jbl_preset", "/");
endif;
#AUDIO EFFECTS PRESETS
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "1" 
then 
ui_print("Installing Exodus Preset...");
package_extract_dir("exodus_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "2" 
then  
ui_print("Installing XPlay3S Preset...");
package_extract_dir("xplay3s_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "1" 
then 
ui_print("Installing Dolby Atmos...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app");
package_extract_dir("asui", "/system/priv-app");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "2" 
then 
ui_print("Installing DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("ds", "/system/priv-app");
package_extract_dir("dsui", "/system/priv-app");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "3" 
then  
ui_print("Installing Dolby Atmos and DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app");
package_extract_dir("asui", "/system/priv-app");
package_extract_dir("ds", "/system/priv-app");
package_extract_dir("dsui", "/system/priv-app");
endif;
endif;
#LP/MM
if 

file_getprop("/tmp/aroma/info.prop","selected.1") == "2" 
then 
ui_print("Configuring for LP/MM...");
package_extract_dir("v4a","/system/priv-app/ViPER4Android_FX_A4.x");
#DTS SYSTEM
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "1" 
then
ui_print("Installing DTS as system app...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_dir("dts","/system/app/DTSClientControllerService");
package_extract_dir("dtslib","/system/app/DTSClientControllerService");
endif;
#DTS DATA
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "2" 
then
ui_print("Installing DTS as user app...");
package_extract_dir("datadts","/data/app");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "1" 
then 
ui_print("Installing Boomsound Preset...");
package_extract_dir("boomsound_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "2" 
then  
ui_print("Installing Harmon Kardon Preset...");
package_extract_dir("hk_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "3" 
then 
ui_print("Installing JBL Preset...");
package_extract_dir("jbl_preset", "/");
endif;
#AUDIO EFFECTS PRESETS
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "1" 
then 
ui_print("Installing Exodus Preset...");
package_extract_dir("exodus_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "2" 
then  
ui_print("Installing XPlay3S Preset...");
package_extract_dir("xplay3s_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "1" 
then 
ui_print("Installing Dolby Atmos...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app/As");
package_extract_dir("asui", "/system/priv-app/AsUi");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "2" 
then 
ui_print("Installing DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("ds", "/system/priv-app/Ds");
package_extract_dir("dsui", "/system/priv-app/DsUi");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "3" 
then  
ui_print("Installing Dolby Atmos and DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app/As");
package_extract_dir("asui", "/system/priv-app/AsUi");
package_extract_dir("ds", "/system/priv-app/Ds");
package_extract_dir("dsui", "/system/priv-app/DsUi");
endif;
endif;
#Npackage_extract_file("permissive.sh", "/system/su.d/permissive.sh");
if 

file_getprop("/tmp/aroma/info.prop","selected.1") == "3" 
then 
ui_print("Configuring for N Preview...");
package_extract_dir("v4a","/system/priv-app/ViPER4Android_FX_A4.x");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
#DTS SYSTEM
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "1" 
then
ui_print("Installing DTS as system app...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_dir("dts","/system/app/DTSClientControllerService");
package_extract_dir("dtslib","/system/app/DTSClientControllerService");
endif;
#DTS DATA
if 

file_getprop("/tmp/aroma/dts.prop","selected.1") == "2" 
then
ui_print("Installing DTS as user app...");
package_extract_dir("datadts","/data/app");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "1" 
then 
ui_print("Installing Boomsound Preset...");
package_extract_dir("boomsound_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "2" 
then  
ui_print("Installing Harmon Kardon Preset...");
package_extract_dir("hk_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.2") == "3" 
then 
ui_print("Installing JBL Preset...");
package_extract_dir("jbl_preset", "/");
endif;
#AUDIO EFFECTS PRESETS
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "1" 
then 
ui_print("Installing Exodus Preset...");
package_extract_dir("exodus_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/preset.prop","selected.1") == "2" 
then  
ui_print("Installing XPlay3S Preset...");
package_extract_dir("xplay3s_preset", "/");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "1" 
then 
ui_print("Installing Dolby Atmos...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app/As");
package_extract_dir("asui", "/system/priv-app/AsUi");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "2" 
then 
ui_print("Installing DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("ds", "/system/priv-app/Ds");
package_extract_dir("dsui", "/system/priv-app/DsUi");
endif;
if 

file_getprop("/tmp/aroma/dolby.prop","selected.1") == "3" 
then  
ui_print("Installing Dolby Atmos and DD+...");
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
package_extract_file("permissive.sh", "/system/su.d/permissive.sh");
set_perm(0, 0, 0755, "/system/su.d/permissive.sh");
delete_recursive("/system/etc/dolby");
delete_recursive("/vendor/etc/dolby");
delete_recursive("/system/vendor/etc/dolby");
package_extract_dir("dd+", "/");
package_extract_dir("dolby", "/");
package_extract_dir("as", "/system/priv-app/As");
package_extract_dir("asui", "/system/priv-app/AsUi");
package_extract_dir("ds", "/system/priv-app/Ds");
package_extract_dir("dsui", "/system/priv-app/DsUi");
endif;
endif;
if 

file_getprop("/tmp/aroma/tweak.prop","selected.1") == "1" 
then 
ui_print("Installing Sonophilos tweak.prop"); 
package_extract_dir("tweakProps/gh", "/sdcard");
endif;
if 

file_getprop("/tmp/aroma/tweak.prop","selected.1") == "2" 
then 
ui_print("Installing gh tweak.prop"); 
package_extract_dir("tweakProps/sono", "/sdcard");
endif;
if 

file_getprop("/tmp/aroma/tweak.prop","selected.1") == "3" 
then 
package_extract_dir("tweakProps/smee", "/sdcard");
endif;
if 

file_getprop("/tmp/aroma/tweak.prop","selected.1") == "5" 
then 
ui_print(" ");
else
package_extract_dir("tweakprop", "/tmp/tweakprop");
run_program("/sbin/busybox", "unzip", "/tmp/tweakprop/tweakprop.zip", "META-INF/com/google/android/*", "-d", "/tmp/tweakprop");
run_program("/sbin/busybox", "sh", "/tmp/tweakprop/META-INF/com/google/android/update-binary", "dummy", "1", "/tmp/tweakprop/tweakprop.zip");
endif;
run_program("/sbin/busybox", "mount", "/system");
run_program("/sbin/busybox", "mount", "/vendor");
if 

file_getprop("/tmp/aroma/phone.prop","selected.1") == "2" 
then
package_extract_dir("nosony","/");
endif;
if 

file_getprop("/tmp/aroma/phone.prop","selected.2") == "2" 
then
package_extract_dir("Bluetooth","/system");
endif;
if 

file_getprop("/tmp/aroma/phone.prop","selected.3") == "2" 
then
package_extract_dir("HTC","/system");
endif;
package_extract_dir("worstenbrood", "/tmp/worstenbrood");
run_program("/sbin/busybox", "unzip", "/tmp/worstenbrood/deepbuffer.zip", "META-INF/com/google/android/*", "-d", "/tmp/worstenbrood");
run_program("/sbin/busybox", "sh", "/tmp/worstenbrood/META-INF/com/google/android/update-binary", "dummy", "1", "/tmp/worstenbrood/deepbuffer.zip");
package_extract_dir("dts","/sdcard");
package_extract_dir("perms","/sdcard");
run_program("/sbin/busybox", "umount", "/system");
run_program("/sbin/busybox", "umount", "/vendor");
ui_print("Done");
set_progress(1.0);
